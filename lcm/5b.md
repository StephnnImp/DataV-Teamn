# `0x5b` Lamp

LM `0xd0` â†’ Broadcast `0xbf`

Activation of indicator lamps, and check control messages in the instrument cluster.

Possible backwards compatibility with vehicles with discrete Check Control Module (CCM). LCM onwards integrated the CCM, thus eliminating the need to send details of bulb failures.

### Related

- `0x5a` [Lamp Request](5a.md)

### Examples
    
    # LCM_III
    D0 07 BF 5B 00 89 00 00 BA
    D0 07 BF 5B 01 C9 02 02 FB
    D0 07 BF 5B 80 20 00 00 93
    D0 07 BF 5B 00 8D 00 00 BE
    D0 07 BF 5B 00 00 00 00 33

    # LCM_IV
    D0 08 BF 5B 1B 00 00 40 00 67
    D0 08 BF 5B 00 00 00 00 00 3C
    D0 08 BF 5B 40 00 04 00 00 78
    D0 08 BF 5B 01 00 00 00 01 3C
    D0 08 BF 5B 03 00 00 00 01 3E

## Parameters

Fixed length. 4-byte bitfield.

    # Byte 1 (MSB)
    
    TURN_RAPID        = 0b1000_0000
    TURN_RIGHT        = 0b0100_0000
    TURN_LEFT         = 0b0010_0000
    FOG_REAR          = 0b0001_0000
    
    FOG_FRONT         = 0b0000_1000
    BEAM_HIGH         = 0b0000_0100
    BEAM_LOW          = 0b0000_0010
    PARKING           = 0b0000_0001
    
    # Byte 2
    
    CCM_LIC_PLATE     = 0b1000_0000
    CCM_TURN_RIGHT    = 0b0100_0000
    CCM_TURN_LEFT     = 0b0010_0000
    CCM_FOG_REAR      = 0b0001_0000
    
    CCM_FOG_FRONT     = 0b0000_1000
    CCM_HIGH_BEAM     = 0b0000_0100
    CCM_LOW_BEAM      = 0b0000_0010
    CCM_PARKING       = 0b0000_0001
    
    # Byte 3
        
    CCM_REVERSE       = 0b0010_0000
    
    INDICATORS        = 0b0000_0100
    CCM_BRAKE         = 0b0000_0010
    
    # Byte 4 (LSB)
    
    FOG_REAR_SWITCH   = 0b0100_0000
    KOMBI_LOW_LEFT    = 0b0010_0000
    KOMBI_LOW_RIGHT   = 0b0001_0000

    KOMBI_BRAKE_LEFT  = 0b0000_0010
    KOMBI_BRAKE_RIGHT = 0b0000_0001
    
    # Pending...
    # CCM_TAIL
    # CCM_TRAILER
    # KOMBI_BRAKE_CENTRE

Later LM variants (`LCM_IV`, `LSZ_2`) added a fifth byte.

    # Byte 5
    
    UNKNOWN           = 0b0000_0001

### Turn Rapid `0b1000_0000`

> If one of the turn signal indicator lamps - not one of the auxiliary signal lamps - is defective, the flashing frequency is doubled.

### Turn Right `0b0100_0000`

Right turn signal indicator.

### Turn Left `0b0010_0000`

Left turn signal indicator.

### Fog Rear `0b0001_0000`

Front fog light indicator.

### Fog Front `0b0000_1000`

Rear fog light indicator.

---

### Indicators `0b0000_0100 << 8`

Set whenever indicator/TURN bits set?

### Fog Rear Switch `0b0100_0000`

Set when fogs switched to rear only?

---

### Unknown `0b0000_0001`

Only values are 0x00 or 0x01

## Use Cases

### Cluster Indicators

> The indicator lamps for **left turn signal indicator**, **right turn signal indicator**, **rear fog light**, **fog light** and **high beam** located in the instrument cluster are activated via the I-Bus/K-bus.

![Left/Right Turn Signal Indicator Lamp](5b/left_right.jpg)
![High Beam Indicator Lamp](5b/high.jpg)
![Front Fog Lamp Indicator Lamp](5b/fog_front.jpg)
![Rear Fog Lamp Indicator Lamp](5b/fog_rear.jpg)

### Check Control (High/IKE) [E38 up to 09/95]

Early E38s had a discrete Check Control Module (CCM) which required input from the Light Module (LM) in order to generate lamp related check control messages. 

This use case became redundant with the introduction of the Light Check Module (LCM) which integrated the CCM. However, the LCM still reports the lamp faults, presumably for backwards compatibility.

> Following messages are preprocessed by the light module and transferred to the check-control module by way of telegram.
>
> - Check brake light  
> - Check high beam  
> - Check low beam  
> - Check parking light  
> - Check tail lights *[rear lamps/side marker lamps]*  
> - Check front fog light  
> - Check rear fog light  
> - Check licence plate light  
> - Check reversing light  
> - Check trailer light

### Check Control (Low/KOMBI)

> On vehicles with the basic system, information is indicated not in the form of text messages but rather by warning lamps and symbols in the LC display field for check control messages in the instrument cluster.

The following warning lamps/symbols are dependent on this command.

> 1\. Check low beam headlights  
> 5\. Check rear light or brake light. A defective third (centre) brake light is indicated by the upper symbol.

![Check Control (KOMBI/Low)](5b/cc_low.jpg)
